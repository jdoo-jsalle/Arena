10 F$=" DDALINMIPSFTTCTRTT"
15 X(1) = 10:Y(1) = 5:X (2) = 20
16 Y(2) = 5:X(3) = 15
17 Y(3) = 10:X(4) = 16:Y(4) = 10
20 DIM A(40,40),AC$(4,20),B$(4,20)
30 DIM SO$(4,20),SN$(4,20)
40 CLS
50 PRINT "NOMBRE DE JOUEURS (1 A 4)   ";: INPUT N
60 INPUT "NB DE PAS (5 A 20) :";PG
70 INPUT "ENERGIE (1500) :";EN
80 INPUT "DIST. REPERAGE (4):";RE
90 FOR J = 1 TO N:NR(J) = EN: NEXT J
100 INPUT "OBSTACLE -10 A + 10 ";OB 
105 GOTO 230
110 REM <<<<<<DESSIN>>>>>>>
120 FOR Y = 1 TO 20
130 FOR X = 1 TO 30
140 TP = INT (RND (1) * 90) + OB
150 IF X = 1 OR Y = 1 OR X = 30 OR Y= 20 THEN V = 8 : PRINT "L";: GOTO 180
160 IF TP => 90 THEN PRINT "L";: V = 8: GOTO 180
170 V = 0: PRINT " ";
180 A(X,Y) = V
190 NEXT X : PRINT : NEXT Y
220 RETURN
230 REM *.... PROGRAMATION .....*
240 FOR J = 1 TO N
250 CLS
260 PRINT : PRINT "LE JOUEUR "J;" RESTE.": 
265 PRINT "LES AUTRE QUITTENT L'ECRAN"
270 GET S$:CLS
275 INPUT "CIRCUIT DE SECOUR ?";CS$(J)
280 FOR P = 1 TO PG: CLS
290 PRINT "<AL.DD.MI.IN.PS.FT.(TT)>":PRINT
300 PRINT "CASE MEMOIRE NO "P;
310 INPUT "CODE ->";A$
320 IF A$ = "" THEN GOTO 310
330 IF A$ = "TT" THEN GOTO 370
340 IF A$ = "DD" THEN INPUT "DIRECTION 0,1,2,3, ou 4 ->";B$
350 AC$(J,P) = A$:B$(J,P) = B$:B$="":GOTO 430
360 AC$(P,J)= A$:GOTO 430
370 CLS
380 AC$(J,P)= "TT"
390 PRINT "MENU TT <AL.MI.IN.PS.FT.TC.TR)>"
400 PRINT "SI OUI >";:INPUT D$
410 PRINT "SI NON >";:INPUT E$
420 SO$(J,P)= D$: SN$(J,P)= E$
430 NEXT P: CLS : NEXT J
440 GOSUB 110
450 REM +.....<ACTION>>.......+
460 REM A)-MISE.EN.PLACE
480 FOR J = 1 TO N: PLOT X(J),Y(J),STR$(J):NEXT J
490 REM B)***MAINLOOP
500 FOR P = 1 TO PG
510 FOR J = 1 TO N
520 PLOT 0,22,"              "
530 FOR SC = 1 TO N : PLOT SC * 6, 22, STR$ (NR (SC)) : NEXT SC
540 IF NR(J) >= 0 THEN GOTO 550
550   NR (J) = 0 : PLOT J * 6, 22, STR$(NR (J)) : A(X(J),Y(J))=0: GOTO 610
550 FOR K = 2 TO 19 STEP 2
560 T$ = MID$ (F$,K,2)
656 PLOT 22,1, T$ 
570 IF T$ = AC$ (J,P) THEN GOTO 590
580 NEXT K
590 ON K/2 GOSUB 680,780,950,870,990,990,990,990,1480
600 IF AC$(J,P) = "0" THEN NR(J) = NR(J) - 50
610 REM FOR JMP
620 T$ = "": NEXT J
630 NEXT P
640 FOR SC = 1 TO N : PLOT SC * 7,22, "     ":NEXT SC
650 GOTO 500
660 REM *--------------------*
670 REM *.. ROUTINES-ACTIONS.*
680 REM <=== DEP CHOISI ====>
690 Z = VAL (B$(J,P))
700 IF Z=1 THEN DX = 0 : DY = -1
710 IF Z=2 THEN DX = 1 : DY = 0
720 IF Z=3 THEN DX = 0 : DY = 1
730 IF Z=4 THEN DX = -1 : DY = 0
740 IF INT (A(X(J) + DX,Y(J) + DY)) <> 0 THEN GOTO 750
741  A (X(J),Y(J))=0 : PLOT X(J),Y(J), " ": 
742  X(J) = X(J) + DX : Y(J) = Y(J) + DY : 
743  PLOT X(J),Y(J), STR$(J): NR(J) = NR(J) - 2 :
744  GOSUB 1670
750 NR(J) =NR(J)-5
760 RETURN
770 REM =====(DEPT.ALEA)=====
780 TH = INT (RND(1) * 4) +1
790 IF TH=1 THEN DX = 0 : DY = -1
800 IF TH=2 THEN DX = 1 : DY = 0
810 IF TH=3 THEN DX = 0 : DY = 1
820 IF TH=4 THEN DX = -1 : DY = 0
830 NR(J) =NR(J)-1
840 IF INT (A(X(J) + DX,Y(J) + DY)) <> 0 THEN GOTO 850
842 A (X(J),Y(J))=0 : PLOT X(J),Y(J), " ": 
843 X(J) = X(J) + DX : Y(J) = Y(J) + DY : 
844 PLOT X(J),Y(J), STR$(J)
845 GOSUB 1670
850 RETURN
860 REM ====(POST.MINE)=====
870 NR(J) =NR(J)-10
880 SF = INT (RND(1) * 4) +1
890 ON SF GOTO 900,910,920,930
900 XX=0:YY=-1:GOTO 935
910 XX=1:YY=0 : GOTO 935
920 XX=0:YY+1:GOTO 935
930 XX=-1:YY=0
935 IF A(X(J)+XX,Y(J) + YY) <> 0 GOTO 940
937 A(X(J)+XX,Y(J)+YY) = J/10: PLOT X(J)+XX,Y(J)+YY,"+"
940 RETURN
950 REM =====(INVISIBILITE)==
960 NR(J) = NR(J)-20
970 L= A(X(J),Y(J)):X1(J)= X(J):Y1(J)=Y(J):PLOT X1(J),Y1(J)," ":L=0
980 RETURN
990 REM ====(REPER.+.PROCHE)==
1000 TT = 0:NR(J) = NR(J) - 4
1010 RP = 100:K= 0:PP=50
1020 FOR I = 1 TO N - 1
1030 K = J + 1
1040 IF K > N THEN K = K - N
1050 D(K) = INT ( SQR (( ABS (X(J) - X(K)) ^ 2) + ABS (Y(J) - Y(K)) ^ 2)))
1060 IF D(K) < PP THEN PP = D(K) : RP = K
1070 NEXT I
1080 DX = X (J) - X (RP)
1090 DY = Y (J) - Y (RP)
1100 IF PP < RE THEN TT = 1
1120 IF AC$(J,P)= "FT" THEN 1160
1120 IF AC$(J,P)= "PS" THEN 1190
1120 IF AC$(J,P)= "TC" THEN 1220
1120 IF AC$(J,P)= "TR" THEN 1350
1150 RETURN
1160 REM   <A>>>>FUITE========
1165 NR(J) = NR(J) - 4
1167 COND = A(X(J) + SGN (DX),Y(J) + SGN(DY))
1170 IF COND <>0 THEN GOTO 1180
1171  A(X(J),Y(J))=0 : PLOT X(J),Y(J)," ": 
1172  X(J) = X(J)+ SGN(DX) :Y(J) = Y(J) + SGN(DY) : 
1173  PLOT X(J),Y(J),CHR$(J):GOSUB 1670
1180 RETURN
1190 REM   <A>>>>POURSUITE=====
1195 NR(J) = NR(J) - 4
1196 COND =A(X(J) - SGN (DX),Y(J) - SGN(DY))
1200 IF COND <> =0 THEN GOTO 1210
1201 A(X(J),Y(J))=0 : PLOT X(J),Y(J)," ":
1202 X(J) = X(J)- SGN(DX) : Y(J) = Y(J) - SGN(DY) : 
1203 PLOT X(J),Y(J),CHR$(J):GOSUB 1670
1210 RETURN
1220 REM =====<TIR.COL.>=======
1230 NR(J) = NR(J) - 3
1240 FOR W = -1 TO 1 STEP 2
1250 FOR S = 1 TO 10 
1260 BB = Y(J) - (S * W)
1270 IF VB = 1 THEN 1320
1280 IF A(X(J),BB) = J / 10 THEN 1320
1281 COND = INT A(X(J),BB)
1290 IF COND < 0  OR COND > 5 THEN GOTO 1300
1291  PLOT X(J),BB,"O":A(X(J),BB) = 1:
1292  PLOT X(J),BB ,CHR$(RP):
1293  N(RP) = N(RP) - 20:GOTO 1320
1300 IF COND <> 0 THEN GOTO 1310
1301  PLOT X(J),BB,"!":A(X(J),BB)=0:
1302  PLOT X(J),BB," ":GOTO 1320
1310 VB=1
1320 NEXT S :VB=0
1330 NEXT W :VB=0
1340 RETURN
1350 REM =====<TIR.RANG.>=======
1360 NR(J) = NR(J) - 3
1370 FOR W = -1 TO 1 STEP 2
1380 FOR S = 1 TO 10 
1390 BB = X(J) - (S * W)
1400 IF VB = 1 THEN 1450
1410 IF A(BB,Y(J)) = J / 10 THEN 1450
1411 COND = INT (BB,A(Y(J))
1420 IF COND < 0  OR COND > 5 THEN GOTO 1430
1421  PLOT BB,Y(J),"W":A(BB,Y(J)) = 1:
1422  PLOT BB,Y(J) ,CHR$(RP)
1423  N(RP) = N(RP) - 20:GOTO 1450
1430 IF COND <> 0 THEN GOTO 1440
1431    PLOT BB,Y(J),"-":A(BB,Y(J))=0:
1432    PLOT BB,Y(J)," ":GOTO 1450
1440 VB=1
1450 NEXT S :VB=0
1460 NEXT W :VB=0
1470 RETURN
1480 REM --------<<TEST.T1>>----
1485 NR(J) =NR(J) - 4
1490 GOSUB 990
1500 IF TT=0 THEN 1590
1510 IF SO$(J,P) = "AL' THEN GOSUB 780
1520 IF SO$(J,P) = "IN' THEN GOSUB 950
1530 IF SO$(J,P) = "MI' THEN GOSUB 870
1540 IF SO$(J,P) = "PS' THEN GOSUB 1190
1550 IF SO$(J,P) = "FT' THEN GOSUB 1160
1560 IF SO$(J,P) = "TC' THEN GOSUB 1220
1570 IF SO$(J,P) = "TR' THEN GOSUB 1350
1580 RETURN
1590 IF SN$(J,P) = "AL' THEN GOSUB 780
1600 IF SN$(J,P) = "IN' THEN GOSUB 950
1610 IF SN$(J,P) = "MI' THEN GOSUB 870
1620 IF SN$(J,P) = "PS' THEN GOSUB 1190
1630 IF SN$(J,P) = "FT' THEN GOSUB 1160
1640 IF SN$(J,P) = "TC' THEN GOSUB 1220
1650 IF SN$(J,P) = "TR' THEN GOSUB 1350
1580 RETURN
1670 REM =====<PIED/MINE.?>=======
1680 IF A(X(J),Y(J)) = 0 THEN A(X(J),Y(J))=1:RETURN
1690 IF A(X,J),Y(J)) = J/10 THEN GOTO 1700
1692  AC$(J,P)= CS$(J): PLOT X(J),Y(J),"*":
1693 A(X(J),Y(J))= 1:PLOT X(J),22, CHR$(J)+"*!":
1694 PLOT X(J),Y(J),CHR$(J):NR(J)=NR(J)-100
1700 RETURN
1710 REM -*MICHEL BRASSINE *-


